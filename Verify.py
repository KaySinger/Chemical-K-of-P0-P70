import numpy as np

# Given data
p_values = [0.0010387619512718564, 0.0014594061006085331, 0.002029987372432075, 0.0027955519718276074, 0.0038115257662514924, 0.005145021625877446, 0.006875948327308125,
            0.009097772219953115, 0.011917758189007081, 0.015456499160930667, 0.019846537775647707, 0.02522989428411382, 0.03175434519650534, 0.03956835064440448,
            0.048814606058677074, 0.059622294478570315, 0.07209823560961329, 0.08631725952227624, 0.10231226646443306, 0.12006455693182297, 0.1394951135813914,
            0.16045757422128745, 0.18273363984261937, 0.2060316036001929, 0.2299885609203704, 0.2541766690192627, 0.2781135747587281, 0.3012768388809829, 0.3231218745222626,
            0.3431026153559824, 0.3606938626147648, 0.37541405839451636, 0.38684711858251963, 0.3946619487633759, 0.3986283672902112, 0.3986283672902112, 0.3946619487633759,
            0.38684711858251963, 0.37541405839451636, 0.3606938626147648, 0.3431026153559824, 0.3231218745222626, 0.3012768388809829, 0.2781135747587281, 0.2541766690192627,
            0.2299885609203704, 0.2060316036001929, 0.18273363984261937, 0.16045757422128745, 0.1394951135813914, 0.12006455693182297, 0.10231226646443306, 0.08631725952227624,
            0.07209823560961329, 0.059622294478570315, 0.048814606058677074, 0.03956835064440448, 0.03175434519650534, 0.02522989428411382, 0.019846537775647707, 0.015456499160930667,
            0.011917758189007081, 0.009097772219953115, 0.006875948327308125, 0.005145021625877446, 0.0038115257662514924, 0.0027955519718276074, 0.002029987372432075,
            0.0014594061006085331, 0.0010387619512718564]
k = [2.19908035, 2.0630384, 2.64991664, 1.88643999, 2.16736185, 0.766506931, 3.03316208, 3.11339445, 2.17253685, 2.08254311, 1.87391706, 2.43482293,
 2.02159939, 1.94486457, 2.22422275, 1.75631384, 1.94389310, 1.54437186, 1.60189645, 1.90360184, 1.74768471, 1.76197608, 1.69790670, 1.75180130,
 2.40802448, 2.35402078, 2.61727428, 2.82933126, 1.94483059, 2.52580305, 1.80374562, 0.834727782, 0.0917276121, 8.12400346, 1.99022999, 1.28475798,
 1.61277875, 1.68522323, 0.764838972, 0.221416790, 0.128305746, 0.615385136, 0.944172998, 1.16822972, 0.817071778, 2.19917708, 2.73116054, 2.01239353,
 2.24578521, 1.82794748, 4.11059144, 1.69511815, 1.76643740, 1.77185171, 1.80790956, 1.86336321, 2.10904863, 1.93412796, 2.28556533, 1.88949752,
 2.22307558, 2.17158458, 1.82332558, 1.78562781, 1.78801237, 1.92250149, 1.85731326, 1.73754935, 1.54728931, 0.00572756724]
k_inv = [0.20153767, 0.19134064, 0.23732587, 0.03255802, 0.15771073, 0.24811196,
 0.21290545, 0.18987229, 0.22211476, 0.20672499, 0.13996405, 0.21935261,
 0.20040802, 0.22148628, 0.22134626, 0.20994172, 0.19730603, 0.21795346,
 0.2077215,  0.21215259, 0.22322331, 0.23433782, 0.22400244, 0.22901549,
 0.20529939, 0.220498,   0.2351124,  0.21024865, 0.32812011, 0.24090135,
 0.32481247, 0.23110735, 0.21410563, 0.32434341, 0.31185524, 0.24638337,
 0.20647858, 0.17746428, 0.28880371, 0.16808373, 0.16502075, 0.14362077,
 0.07955503, 0.24117328, 0.2936324,  0.21879703, 0.23643677, 0.24473412,
 0.23260574, 0.23390451, 0.23231876, 0.20065555, 0.21495304, 0.21300463,
 0.22335477, 0.21320281, 0.20168259, 0.23371616, 0.17241245, 0.22073107,
 0.22792687, 0.22428861, 0.21315923, 0.2237663,  0.23055055, 0.00409472,
 0.21138445, 0.26278119, 0.00481194]


# Function to calculate dpdt
def equations(p, t, k_values):
    k = k_values[:70]
    k_inv = k_values[70:]
    dpdt = [0] * 71
    dpdt[0] = -k[0] * p[0]
    dpdt[1] = k[0] * p[0] + k_inv[0] * p[2] - k[1] * p[1] ** 2
    for i in range(2, 70):
        dpdt[i] = k[i-1] * p[i-1] ** 2 + k_inv[i-1] * p[i+1] - k_inv[i-2] * p[i] - k[i] * p[i] ** 2

    dpdt[70] = k[69] * p[69] ** 2 - k_inv[68] * p[70]

    return dpdt


k_values = np.array(k + k_inv)


dpdt_values = equations(p_values, 0, k_values)

# Check for near-zero values in dpdt
for i, dpdt in enumerate(dpdt_values):
    print(f"dpdt[{i}] = {dpdt}")

